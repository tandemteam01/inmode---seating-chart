<script>

let guests = [];

const sheetID = "1oDF4vOZ2ZgBPbXgIFSQo1jQpa08nP8S9eVw3duDoNJ0";
const sheetName = "Sheet1";

const url = "https://opensheet.elk.sh/" + sheetID + "/" + sheetName;

fetch(url)
  .then(res => res.json())
  .then(data => {
    guests = data.map(row => ({
      name: (row.name || "").toLowerCase(),
      table: row.table || "",
      seat: row.seat || ""
    }));
  })
  .catch(error => {
    document.body.innerHTML = "<h2>Error loading Google Sheet</h2>";
    console.log(error);
  });

function searchSeat() {
  let name = document.getElementById("nameInput").value.toLowerCase().trim();
  let results = guests.filter(g => g.name.includes(name));

  if (results.length === 1) {
    document.getElementById("result").innerHTML =
      "Table: <b>" + results[0].table +
      "</b><br>Seat: <b>" + results[0].seat + "</b>";
  }
  else if (results.length > 1) {
    let list = "<p>Multiple results found:</p>";
    results.forEach(g => {
      list += g.name + " - Table " + g.table +
              " Seat " + g.seat + "<br>";
    });
    document.getElementById("result").innerHTML = list;
  }
  else {
    document.getElementById("result").innerHTML = "Name not found";
  }
}

</script>
