<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>INMODE Seating Chart</title>

<style>
body {
  background-color:#000;
  color:white;
  text-align:center;
  font-family:Arial;
}

input {
  padding:10px;
  width:300px;
  font-size:16px;
}

button {
  padding:10px 20px;
  font-size:16px;
  background:#d4af37;
  border:none;
  cursor:pointer;
}

.gold {
  color:#d4af37;
}

#mapSection {
  display:none;
  margin-top:40px;
}
</style>
</head>

<body>

<h4 style="color:#aaa;">Welcome to</h4>
<h1 class="gold" style="font-size:50px;">THE INMODE ERA</h1>
<h3>The Dawn of Innovation</h3>

<p>Please Enter your Registered name.</p>

<input type="text" id="nameInput" placeholder="Type your name here">
<button onclick="searchSeat()">Search</button>

<p id="status">Your personalized seating information awaits.</p>
<div id="result"></div>

<div id="mapSection">
  <p style="margin-top:30px;">
    Please refer to the seating map below to locate your table.
  </p>
  <img src="seating-map.png" width="900">
</div>

<script>

const SHEET_ID = "1oDF4vOZ2ZgBPbXgIFSQo1jQpa08nP8S9eVw3duDoNJ0";
const SHEET_NAME = "guests";
const url = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;

let guests = [];

fetch(url)
  .then(res => res.json())
  .then(data => {
    guests = data;
  });

document.getElementById("nameInput")
  .addEventListener("keyup", function(event) {
    if (event.key === "Enter") {
      searchSeat();
    }
  });

function searchSeat() {

  const name = document
    .getElementById("nameInput")
    .value
    .toLowerCase()
    .trim();

  const results = guests.filter(g =>
    g.name.toLowerCase().includes(name)
  );

  const resultDiv = document.getElementById("result");
  const map = document.getElementById("mapSection");

  resultDiv.innerHTML = "";
  map.style.display = "none";

  if (results.length === 0) {
    resultDiv.innerHTML = "Name not found.";
  }

  else if (results.length === 1) {

    const guest = results[0];

    resultDiv.innerHTML = `
      <h2>Welcome, ${guest.name}</h2>
      <p>to <span class="gold">THE INMODE ERA</span></p>
      <br>
      <h3>Please proceed to</h3>
      <h1 class="gold" style="font-size:60px;">TABLE ${guest.table}</h1>
      <h3>Your seat number is</h3>
      <h1 class="gold" style="font-size:70px;">${guest.seat}</h1>
    `;

    map.style.display = "block";
  }

  else {

    let listHTML = `<h3>Multiple matches found:</h3><br>`;

    results.forEach(g => {
      listHTML += `
        <p style="font-size:20px;">
          ${g.name} â€” Table ${g.table} Seat ${g.seat}
        </p>
      `;
    });

    resultDiv.innerHTML = listHTML;
  }
}

</script>

</body>
</html>
