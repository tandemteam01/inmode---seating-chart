<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Find Your Seat</title>

<style>
body {
  font-family: Arial, sans-serif;
  text-align: center;
  padding: 60px;
}
input {
  padding: 12px;
  width: 280px;
}
button {
  padding: 12px 20px;
  margin-left: 10px;
}
.result {
  margin-top: 30px;
  font-size: 24px;
}
.status {
  margin-top: 10px;
  font-size: 14px;
}
</style>
</head>

<body>

<h2>Welcome</h2>
<p>Enter your full name</p>

<input type="text" id="nameInput" placeholder="Type your name">
<button onclick="searchSeat()">Search</button>

<div class="status" id="status">Loading guest list...</div>
<div class="result" id="result"></div>

<script>

let guests = [];

// ✅ ใส่ Google Sheet ID ให้แล้ว
const sheetID = "1oDF4vOZ2ZgBPbXgIFSQo1jQpa08nP8S9eVw3duDoNJ0";

// ⚠️ ชื่อแท็บต้องตรงกับใน Google Sheet
// ถ้าแท็บชื่ออื่น ให้เปลี่ยนตรงนี้
const sheetName = "Sheet1";

const url = "https://opensheet.elk.sh/" + sheetID + "/" + sheetName;

fetch(url)
  .then(res => res.json())
  .then(data => {
    guests = data.map(row => ({
      name: (row.name || "").toLowerCase(),
      table: row.table || "",
      seat: row.seat || ""
    }));
    document.getElementById("status").innerHTML =
      "Loaded " + guests.length + " guests";
  })
  .catch(error => {
    document.getElementById("status").innerHTML =
      "Error loading Google Sheet";
    console.log(error);
  });

function searchSeat() {
  let name = document.getElementById("nameInput").value.toLowerCase().trim();
  let results = guests.filter(g => g.name.includes(name));

  if (results.length === 1) {
    document.getElementById("result").innerHTML =
      "Table: <b>" + results[0].table +
      "</b><br>Seat: <b>" + results[0].seat + "</b>";
  }
  else if (results.length > 1) {
    let list = "<p>Please select your name:</p>";
    results.forEach(g => {
      list += g.name + " - Table " + g.table +
              " Seat " + g.seat + "<br>";
    });
    document.getElementById("result").innerHTML = list;
  }
  else {
    document.getElementById("result").innerHTML = "Name not found";
  }
}

// ✅ กด Enter แล้วค้นหาได้เลย
document.getElementById("nameInput").addEventListener("keydown", function(e) {
  if (e.key === "Enter") {
    e.preventDefault();
    searchSeat();
  }
});

</script>

</body>
</html>
