<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>THE INMODE ERA</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:radial-gradient(circle,#1a1a1a,#000);
  color:#d4af37;
  text-align:center;
  padding:60px 20px;
}
.small{font-size:14px;color:#aaa;letter-spacing:2px;}
.big{font-size:48px;font-weight:bold;text-shadow:0 0 20px #d4af37;}
.subtitle{color:#fff;margin-bottom:30px;}
input{
  padding:14px;
  width:320px;
  max-width:85vw;
  background:#111;
  border:1px solid #d4af37;
  color:#fff;
  font-size:16px;
}
button{
  padding:14px 24px;
  background:#d4af37;
  border:none;
  font-weight:bold;
  cursor:pointer;
}
.status{margin-top:15px;color:#fff;opacity:.7;}
.result{margin-top:40px;}
.map{display:none;margin-top:40px;}
.map img{width:95%;max-width:1100px;}
</style>
</head>

<body>

<div class="small">Welcome to</div>
<div class="big">THE INMODE ERA</div>
<div class="subtitle">The Dawn of Innovation</div>

<p style="color:white;">Please Enter your Registered name.</p>

<input type="text" id="nameInput" placeholder="Type your name">
<button onclick="searchSeat()">Search</button>

<div class="status" id="status">
Your personalized seating information awaits.
</div>

<div class="result" id="result"></div>

<div class="map" id="map">
<p style="color:white;">
Please refer to the seating map below to locate your table.
</p>
<img src="seating-map.png">
</div>

<script>

const SHEET_ID = "1oDF4vOZ2ZgBPbXgIFSQo1jQpa08nP8S9eVw3duDoNJ0";
const SHEET_NAME = "guests";
const URL = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;

let guests = [];

fetch(URL)
  .then(res => res.json())
  .then(data => {
    guests = data;
  });

function normalize(str){
  return (str || "").toString().trim().toLowerCase();
}

function searchSeat(){

  const input = normalize(document.getElementById("nameInput").value);
  const resultDiv = document.getElementById("result");
  const mapDiv = document.getElementById("map");

  resultDiv.innerHTML = "";
  mapDiv.style.display = "none";

  // ✅ เริ่มค้นที่ 2 ตัวอักษร
  if(input.length < 2){
    resultDiv.innerHTML = "<p style='color:white;'>Please type at least 2 characters.</p>";
    return;
  }

  const results = guests.filter(g =>
    normalize(g.name).includes(input)
  );

  if(results.length === 0){
    resultDiv.innerHTML = "<p style='color:white;'>Name not found.</p>";
    return;
  }

  if(results.length === 1){

    const g = results[0];

    resultDiv.innerHTML = `
      <h2 style="color:white;">Welcome, ${g.name}</h2>
      <div style="margin-bottom:20px;">to <span style="color:#d4af37;">THE INMODE ERA</span></div>
      <div style="color:white;">Please proceed to</div>
      <div style="font-size:44px;">TABLE ${g.table}</div>
      <div style="color:white;">Your seat number is</div>
      <div style="font-size:44px;">${g.seat}</div>
    `;

    mapDiv.style.display = "block";
  }

  else{

    let html = "<h3 style='color:white;'>Multiple results found:</h3>";

    results.slice(0,30).forEach(g=>{
      html += `
      <div style="color:white;font-size:18px;margin:6px 0;">
      ${g.name} — Table ${g.table} Seat ${g.seat}
      </div>`;
    });

    resultDiv.innerHTML = html;
  }
}

// Enter key
document.getElementById("nameInput")
.addEventListener("keydown", function(e){
  if(e.key === "Enter"){
    searchSeat();
  }
});

</script>

</body>
</html>
