<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>THE INMODE ERA</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
  color: #d4af37;
  text-align: center;
  padding: 60px 20px;
}

.small-title {
  font-size: 14px;
  letter-spacing: 2px;
  opacity: 0.8;
}

.big-title {
  font-size: 44px;
  font-weight: bold;
  margin: 10px 0;
  text-shadow: 0 0 20px rgba(212,175,55,0.6);
}

.subtitle {
  font-size: 16px;
  margin-bottom: 40px;
  opacity: 0.85;
}

input {
  padding: 14px;
  width: 300px;
  max-width: 80%;
  border: 1px solid #d4af37;
  background: #111;
  color: #fff;
  font-size: 16px;
  outline: none;
}

input::placeholder {
  color: #aaa;
}

button {
  padding: 14px 24px;
  margin-left: 10px;
  background: #d4af37;
  border: none;
  color: #000;
  font-weight: bold;
  cursor: pointer;
}

button:hover {
  background: #f1d37a;
}

.result {
  margin-top: 40px;
  font-size: 24px;
  animation: fadeIn 0.5s ease;
}

.status {
  margin-top: 15px;
  font-size: 13px;
  opacity: 0.6;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
</head>

<body>

<div class="small-title">Welcome to</div>
<div class="big-title">THE INMODE ERA</div>
<div class="subtitle">The Dawn of Innovation</div>

<p>Please Enter your Registered name.</p>

<input type="text" id="nameInput" placeholder="Type your name">
<button onclick="searchSeat()">Search</button>

<div class="status" id="status">Loading guest list...</div>
<div class="result" id="result"></div>

<script>

let guests = [];

// Google Sheet ID ของพี่
const sheetID = "1oDF4vOZ2ZgBPbXgIFSQo1jQpa08nP8S9eVw3duDoNJ0";

// ชื่อแท็บ
const sheetName = "guests";

const url = "https://opensheet.elk.sh/" + sheetID + "/" + sheetName;

function normalize(str) {
  return (str || "")
    .toString()
    .trim()
    .toLowerCase();
}

fetch(url)
  .then(res => res.json())
  .then(data => {
    guests = data.map(row => ({
      name: normalize(row.name),
      table: row.table || "",
      seat: row.seat || ""
    }));
    document.getElementById("status").innerHTML =
      "Loaded " + guests.length + " guests";
  })
  .catch(error => {
    document.getElementById("status").innerHTML =
      "Unable to load guest list.";
    console.log(error);
  });

function searchSeat() {
  let name = normalize(document.getElementById("nameInput").value);
  let results = guests.filter(g => g.name.includes(name));

  if (results.length === 1) {
    document.getElementById("result").innerHTML =
      "<div style='font-size:18px; color:white;'>Please proceed to</div>" +
      "<div style='font-size:40px; margin:10px 0;'>TABLE " + results[0].table + "</div>" +
      "<div style='font-size:18px; color:white;'>Your seat number is</div>" +
      "<div style='font-size:40px; margin-top:10px;'>" + results[0].seat + "</div>";
  }
  else if (results.length > 1) {
    let list = "<div style='font-size:18px; color:white;'>Please select your name</div><br>";
    results.forEach(g => {
      list += g.name + " — TABLE " + g.table +
              " SEAT " + g.seat + "<br>";
    });
    document.getElementById("result").innerHTML = list;
  }
  else {
    document.getElementById("result").innerHTML = "Name not found";
  }
}

// กด Enter แล้วค้นหา
document.getElementById("nameInput").addEventListener("keydown", function(e) {
  if (e.key === "Enter") {
    e.preventDefault();
    searchSeat();
  }
});

</script>

</body>
</html>
